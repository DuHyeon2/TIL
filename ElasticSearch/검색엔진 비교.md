## OpenSearch-Operator
- **정의 및 특징**
    - OpenSearch Operator는 Apache 2.0 라이선스를 받은 완전 오픈 소스 Kubernetes Operator로 OpenSearch 클러스터와 **OpenSearch 대시보드**의 배포, 프로비저닝, 관리 및 오케스트레이션을 자동화하는 데 사용
    - Kibana 대신 **OpenSearch Dashboards** 사용
    - Helm으로 Operator 설치 후, **CR(YAML)** 로 클러스터/대시보드/정책들을 선언적 관리 가능
    - **데이터 수명주기/백업**은 OpenSearch의 **ISM/SM**(플러그인 기능)으로 정책 설정해서 자동화

- **장점**
    ```
    - 완전 오픈소스
    - 관련 자료가 비교적 많음
    - 고급 기능도 전부 오픈소스 번들이라 비용 및 제약 적음
    - drainDataNodes 옵션으로 롤링/재시작 시 샤드 드레인
    ```
- **단점**
    ```
    - Elastic만의 상용급 특화 기능(예: Searchable Snapshot/Frozen tier, 일부 오케스트레이션 옵션)이 동일 수준으로는 없음
    - 스냅샷/보존은 Operator가 아니라 ISM/SM(엔진 정책)으로 별도 선언 필요
    ```
- **CloudPG 유사 운영 매핑**
  - **ScheduledBackup ↔ Snapshot Management(SM)**: 스냅샷 레포지토리(S3/MinIO) 등록 + SM 정책으로 스케줄/보존
  - **Retention/아카이빙 ↔ ISM**: 인덱스 패턴별 롤오버→보존→삭제 자동화
  - **무중단 교체/드레인**: `spec.general.drainDataNodes: true` + 멀티노드/replica≥1 구성 시 효과적
  - **PVC 내구성**: `nodePools.persistence.storageClass + diskSize`
  - **단일 노드 최적화**: `OpensearchIndexTemplate`로 `index.number_of_replicas: 0` 기본화

- **관련 링크**
    - https://docs.opensearch.org/latest/tools/k8s-operator/
    - https://opensearch-project.github.io/opensearch-k8s-operator/docs/userguide/main.html
    - https://github.com/opensearch-project/opensearch-k8s-operator
    - https://docs.opensearch.org/latest/im-plugin/ism/index

------------------------------------------------------------------------

## ECK
- **정의 및 특징**
    - Kubernetes에서 Elasticsearch, Kibana, APM Server, Beats, Enterprise Search, Elastic Agent, Elastic Maps Server 및 Logstash의 배포, 프로비저닝, 관리 및 오케스트레이션을 자동화하는 Elastic의 공식 운영자
    - **Elastic License 2.0(ELv2)** 자체 호스팅/내부 사용은 **Basic**으로 무료 가능(일부 고급 기능은 상위 구독 필요)
    - **ILM**(Index Lifecycle Management)으로 롤오버/보존, **SLM**(Snapshot Lifecycle)으로 스냅샷 스케줄
    - Kibana에서 정책/스냅샷 관리 UI 제공

- **장점**
    ```
    - Basic 라이센스는 무료
    - 관련 자료가 많음
    - 하나의 오퍼레이터로 ES/Kibana/Logstash/Beats/Agent까지 운영 가능
    ```

- **단점**
    ```
    - ECK 자체는 Basic 무료지만 오퍼레이터의 특정 고급기능 ES 오토스케일링은 엔터프라이즈 라이선스 필요하며, 엔진/스택 일부도 라이선스 레벨에 따라 차등
    ```

- **CloudPG 유사 운영 매핑**
  - **ScheduledBackup ↔ SLM**: 스냅샷 레포지토리 등록 + SLM 정책
  - **Retention/아카이빙 ↔ ILM**: 인덱스 수명주기 정책
  - **무중단 교체**: 노드셋 롤링/토폴로지 변경은 ECK가 오케스트레이션

- **관련 링크**
    - https://github.com/elastic/cloud-on-k8s
    - https://www.elastic.co/docs/deploy-manage/license/manage-your-license-in-eck
    
------------------------------------------------------------------------

## Solr-operator
- **정의 및 특징**
    - SolrCloud를 쿠버네티스에서 CRD로 선언/운영하는 공식 오퍼레이터로 백업, 복구, Prometheus Exporter, Helm 배포 지원

- **장점**
    ```
    - 완전 오픈소스
    - SolrCloud 클러스터 오케스트레이션, 프로메테우스 익스포터/백업 통합 등 제공
    ```

- **단점**
    ```
    - 관련 자료가 너무 없음
    - 호환성/확장 고려
    ```

- **관련 링크**
    - https://artifacthub.io/packages/helm/apache-solr/solr-operator
    - https://solr.apache.org/operator/resources.html

------------------------------------------------------------------------

## 기능 대조표 (CloudPG 와 비교했을 때)

| 항목 | **CloudNativePG** | **OpenSearch Operator** | **ECK (Basic)** | **Solr-operator** |
|---|---|---|---|---|
| 라이선스 | Apache-2.0 | Apache-2.0 | ELv2(Basic 무료) | Apache-2.0 |
| 대상 엔진 | PostgreSQL | OpenSearch | Elasticsearch(+ Stack) | Solr |
| 배포/업그레이드/TLS | 오퍼레이터 | 오퍼레이터 | 오퍼레이터 | 오퍼레이터 |
| **데이터 수명주기** | 파티셔닝/아카이빙 직접 설계 | **ISM** 정책(롤오버/보존/삭제) | **ILM** 정책(롤오버/보존/삭제) | Solr Collection/Autoscaling 정책 등 |
| **스냅샷/백업 스케줄** | **Backup/ScheduledBackup CR + PITR** | **SM 정책** + 스냅샷 리포지토리(S3/MinIO 등) | **SLM 정책** + 리포지토리 등록 | Solr 백업 기능/연동 |
| 장애조치(HA) | Primary/Replica 자동 승격 | 샤드/레플리카 기반 가용성 | 샤드/레플리카 기반 가용성 | SolrCloud 레플리카 기반 |
| 드레인/롤링 보조 | Switchover/재조정 | `drainDataNodes: true` | 롤링 전략 제공 | 롤링 전략 제공 |

> 해석: **CloudPG의 “데이터 레벨 자동화(PITR/스케줄 백업)”**에 가장 비슷한 감각을 내려면 OpenSearch/ECK 모두 **엔진 정책(ISM/SM or ILM/SLM)** 을 **선언적으로** 붙여야 한다. 오퍼레이터는 주로 **클러스터 수명주기**(배포/업글/TLS/드레인)를 맡는다.

---

## 선택 가이드
- **완전 OSS/제약 최소**가 최우선 → **OpenSearch Operator**
- **Elastic 생태계(문서/도구/UI) 활용**이 중요하고 **ELv2 OK** → **ECK(Basic)**
- **Solr** 워크로드/레거시 호환이 핵심 → **Solr-operator**

---

## OpenSearch 기준 적용 주의사항
1) **PVC 사용**: `nodePools.persistence.storageClass + diskSize` 지정(\*emptyDir 금지)
2) **롤링/드레인**: `spec.general.drainDataNodes: true`
3) **단일 노드 기본값**: `OpensearchIndexTemplate` 로 `index.number_of_replicas: 0`
4) **보존/롤오버**: `OpenSearchISMPolicy` 로 패턴별 정책(`logs-*`, `metrics-*` 등)
5) **스냅샷**: S3/MinIO **Secret + Repo 등록 Job + SM 정책 Job** (매일/주간 등 스케줄)
6) **외부 노출**: Ingress 종단 TLS(공인 인증서), Dashboards 검증 모드 운영값으로

## ECK 기준 적용 주의사항
1) **PVC 사용**: 
2) **보안/TLS & 접근**
3) **데이터 수명주기(ILM) + 템플릿/데이터 스트림**
4) **스냅샷/백업(SLM)**
5) **롤링 업그레이드/유지보수**
6) **리소스·토폴로지/운영 튜닝**

---

## 참고
- 팀 표준 네임스페이스/스토리지클래스/MinIO 엔드포인트를 values로 추출해 **Kustomize/Helm** 템플릿화 권장
- 운영/개발 프로파일 분리: 개발은 `replicas: 0`, 운영은 `replicas: 1` 템플릿 분기
- 멀티노드 전환 시 인덱스 템플릿을 `replicas: 1`로 상향하고, 배경 롤오버를 유도해 데이터 재분배
